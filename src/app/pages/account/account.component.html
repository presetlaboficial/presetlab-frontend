<section class="account-page">
  <div class="account-card">
    <header class="profile-header">
      <div class="avatar-circle">
        {{ (auth.user$ | async)?.email?.[0] | uppercase }}
      </div>
      <div class="profile-info">
        <h1>Minha Conta</h1>
        <p class="email">{{ (auth.user$ | async)?.email }}</p>
      </div>
    </header>

    <div class="divider"></div>

    <div class="section-title">
      <h2>HistÃ³rico de Pedidos</h2>
    </div>

    <ng-container *ngIf="orders$ | async as orders">
      <div *ngIf="orders.length === 0" class="empty-state">
        <span class="icon">ðŸ“¦</span>
        <p>VocÃª ainda nÃ£o fez nenhum pedido.</p>
        <button routerLink="/" class="btn-shop">Ir Ã s compras</button>
      </div>

      <div class="orders-list">
        <div
          class="order-item"
          *ngFor="let order of orders"
          [routerLink]="['/account/orders', order.id]"
        >
          <div class="order-top">
            <div class="id-group">
              <span class="label">Pedido</span>
              <strong class="order-id"
                >#{{ order.id?.slice(0, 8) | uppercase }}</strong
              >
            </div>

            <span class="status-badge" [ngClass]="order.status">
              {{ order.status | titlecase }}
            </span>
          </div>

          <div class="order-details">
            <div class="info-col">
              <span class="label">Data</span>
              <span>{{ order.createdAt?.toDate() | date: "dd/MM/yyyy" }}</span>
            </div>
            <div class="info-col">
              <span class="label">Itens</span>
              <span>{{ order.items.length }} produto(s)</span>
            </div>
            <div class="info-col total-col">
              <span class="label">Total</span>
              <strong class="total-value">{{
                order.total | currency: "BRL"
              }}</strong>
            </div>
          </div>

          <div *ngIf="order.status === 'pendente'" class="quick-action">
            <a
              [href]="order.stripeUrl"
              class="btn-pay-sm"
              (click)="$event.stopPropagation()"
            >
              Pagar Agora â†’
            </a>
          </div>
        </div>
      </div>
    </ng-container>

    <div class="divider"></div>

    <button class="btn-logout" (click)="auth.logout()">
      Sair da conta
    </button>
  </div>
</section>
