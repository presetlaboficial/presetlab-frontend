<section class="checkout-card">
  <header class="checkout-header">
    <h1>Finalizar Pedido</h1>
    <ng-container *ngIf="user$ | async as user">
      <div class="user-badge">
        <span class="avatar">
          {{ user.email?.[0] | uppercase }}
        </span>
        <span class="email">{{ user.email }}</span>
      </div>
    </ng-container>
  </header>

  <div class="items-container">
    <ng-container *ngIf="cart$ | async as items">
      <div *ngIf="items.length === 0" class="empty-state">
        <i class="icon-cart-empty"></i>
        <p>Seu carrinho estÃ¡ vazio.</p>
        <button class="btn-link">Voltar Ã  loja</button>
      </div>

      <ul *ngIf="items.length > 0" class="item-list">
        <li *ngFor="let item of items" class="item">
          <div class="item-image">
            <img
              [src]="item.image || 'assets/placeholder.png'"
              alt="{{ item.name }}"
            />
          </div>

          <div class="item-details">
            <span class="item-name">{{ item.name }}</span>
            <span class="item-qty">Qtd: {{ item.quantity || 1 }}</span>
          </div>

          <div class="item-price">
            {{ item.price | currency: "BRL" }}
          </div>
        </li>
      </ul>
    </ng-container>
  </div>

  <footer class="checkout-footer">
    <div class="summary-row">
      <span>Subtotal</span>
      <span>{{ total$ | async | currency: "BRL" }}</span>
    </div>
    <div class="summary-row highlight">
      <strong>Total</strong>
      <strong class="total-price">{{
        total$ | async | currency: "BRL"
      }}</strong>
    </div>

    <button
      (click)="confirmOrder()"
      [disabled]="(cart$ | async)?.length === 0 || isLoading"
      class="btn-confirm"
      [class.loading]="isLoading"
    >
      <ng-container *ngIf="!isLoading; else loadingText">
        Confirmar e Pagar
        <span class="arrow">â†’</span>
      </ng-container>

      <ng-template #loadingText>
        Processando...
      </ng-template>
    </button>

    <p class="security-note">
      <span class="lock-icon">ðŸ”’</span> Ambiente seguro
    </p>
  </footer>
</section>
