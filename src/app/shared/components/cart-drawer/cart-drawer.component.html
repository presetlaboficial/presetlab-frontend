<div class="overlay" *ngIf="isOpen$ | async" (click)="close()"></div>

<aside class="drawer" [class.open]="isOpen$ | async">
  <header class="drawer-header">
    <h3>Seu Carrinho</h3>
    <button (click)="close()">âœ•</button>
  </header>

  <div class="items">
    <ng-container *ngIf="items$ | async as items">
      <div *ngFor="let item of items" class="item">
        <img [src]="item.image || 'assets/placeholder.png'" [alt]="item.name" />

        <div class="info">
          <div>{{ item.name }}</div>
          <small>{{ item.quantity }}x R$ {{ item.price }}</small>
        </div>

        <button class="remove" (click)="remove(item.productId)">ğŸ—‘ï¸</button>
      </div>

      <div *ngIf="items.length === 0" class="empty">
        <p>Seu carrinho estÃ¡ vazio.</p>
      </div>
    </ng-container>
  </div>

  <footer class="drawer-footer" *ngIf="cartTotal$ | async as total">
    <ng-container *ngIf="total > 0">
      <div class="total">
        <span>Total</span>
        <strong>R$ {{ total | number: "1.2-2" }}</strong>
      </div>

      <button
        class="checkout"
        *ngIf="auth.user$ | async; else loginRequired"
        (click)="checkout()"
      >
        Finalizar compra
      </button>

      <ng-template #loginRequired>
        <button class="checkout disabled" (click)="goToLogin()">
          FaÃ§a login para continuar
        </button>
      </ng-template>
    </ng-container>
  </footer>
</aside>
